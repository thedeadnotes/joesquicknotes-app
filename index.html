<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Real-time Note App</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <style>
        /* General Body and Container Styles */
        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; /* More modern font stack */
            margin: 0;
            background-color: #f4f7f6; /* Lighter, subtle background */
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.6;
        }

        #main-app-content {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 25px; /* Slightly increased gap */
            max-width: 900px;
            margin: 20px auto;
            width: 100%;
            box-sizing: border-box;
        }

        /* Header Styles */
        header {
            background-color: #00796b; /* Darker Teal */
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* More pronounced shadow */
            position: sticky; /* Make header sticky */
            top: 0;
            z-index: 1000; /* Ensure it stays on top */
        }

        header h1 {
            margin: 0;
            font-size: 2em; /* Slightly larger title */
            color: white;
            font-weight: 600; /* Bolder */
        }

        #user-display {
            margin-right: 15px;
            font-weight: normal; /* Less bold */
            font-size: 0.95em;
            opacity: 0.8; /* Softer text */
        }

        /* --- GUI IMPROVEMENTS START HERE --- */

        /* Interactive Home Page Options */
        #home-page-options {
            background-color: #ffffff; /* White background for the options box */
            padding: 60px 30px; /* More padding */
            border-radius: 12px; /* Softer corners */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); /* Enhanced shadow */
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px; /* More space between buttons */
            min-height: 250px; /* Minimum height for better visual balance */
            justify-content: center;
        }

        #home-page-options h2 {
            font-size: 2.2em; /* Larger welcome message */
            color: #00796b; /* Matching header teal */
            margin-bottom: 20px;
        }

        #home-page-options button {
            width: 280px; /* Wider buttons */
            padding: 18px 25px; /* More padding for a "fuller" button */
            font-size: 1.3em; /* Larger text */
            background-color: #00796b; /* Darker Teal */
            color: white;
            border: none;
            border-radius: 8px; /* Slightly more rounded */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease; /* Added transform and box-shadow for hover */
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        #home-page-options button:hover {
            background-color: #005a4e; /* Even darker teal */
            transform: translateY(-3px); /* Lift effect on hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); /* Deeper shadow on hover */
        }

        /* Initially hide these sections */
        #add-note-section, #notes-list {
            display: none;
            opacity: 0; /* For fade-in effect */
            transform: translateY(20px); /* For slide-up effect */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out; /* Smooth transition */
        }

        /* Styles for when sections are active (toggled by JS) */
        #add-note-section.active, #notes-list.active {
            opacity: 1;
            transform: translateY(0);
            display: block; /* For form */
        }
        #notes-list.active {
            display: grid; /* Maintain grid for notes list when active */
        }

        /* Add Note Section (Form) */
        #add-note-section {
            background-color: #ffffff;
            padding: 30px; /* Increased padding */
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        #add-note-section h2 {
            margin-top: 0;
            color: #00796b;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 25px; /* More space below heading */
            font-size: 1.8em;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px; /* More space between form groups */
        }

        .form-group label {
            display: block;
            margin-bottom: 8px; /* More space between label and input */
            font-weight: bold;
            color: #555;
            font-size: 1.05em;
        }

        .form-group input[type="text"],
        .form-group textarea {
            width: calc(100% - 24px); /* Account for padding */
            padding: 12px; /* More padding inside inputs */
            border: 1px solid #ccc; /* Softer border */
            border-radius: 6px;
            font-size: 1.05em;
            box-sizing: border-box; /* Include padding in width calculation */
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-group input[type="text"]:focus,
        .form-group textarea:focus {
            border-color: #00796b; /* Teal border on focus */
            box-shadow: 0 0 0 3px rgba(0, 121, 107, 0.2); /* Subtle glow on focus */
            outline: none; /* Remove default outline */
        }

        textarea {
            resize: vertical; /* Allow vertical resizing only */
            min-height: 100px; /* Minimum height for textarea */
        }

        button[type="submit"] {
            background-color: #00796b;
            color: white;
            padding: 14px 25px; /* Larger submit button */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            margin-top: 10px; /* Space above submit button */
        }

        button[type="submit"]:hover {
            background-color: #005a4e;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

        /* Notes List */
        #notes-list {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px; /* Maintained gap */
        }

        .note-card {
            background-color: #ffffff;
            border: 1px solid #e0e0e0; /* Lighter border */
            border-radius: 10px; /* Softer corners */
            padding: 20px; /* More padding */
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08); /* Improved shadow */
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s ease, box-shadow 0.2s ease; /* Smooth hover effect */
        }

        .note-card:hover {
            transform: translateY(-5px); /* Lift card on hover */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); /* Stronger shadow on hover */
        }

        .note-card h3 {
            font-size: 1.5em; /* Larger note title */
            margin-top: 0;
            margin-bottom: 12px; /* More space below title */
            color: #222; /* Darker for better contrast */
            word-break: break-word; /* Prevents long words from overflowing */
        }

        .note-card p {
            font-size: 1em; /* Standard text size */
            margin-bottom: 15px; /* More space below content */
            color: #444; /* Slightly softer text */
            flex-grow: 1;
            overflow-wrap: break-word; /* Ensures text wraps */
        }

        .note-card .meta-info {
            font-size: 0.85em; /* Slightly larger meta info */
            color: #888; /* Softer color */
            border-top: 1px solid #f0f0f0; /* Lighter separator */
            padding-top: 10px;
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .delete-note-btn {
            background-color: #dc3545; /* Bootstrap-like red for delete */
            color: white;
            border: none;
            padding: 6px 10px; /* More padding */
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            line-height: 1;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }

        .delete-note-btn:hover {
            background-color: #c82333; /* Darker red on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
        }

        /* Back to Home Buttons */
        .back-button-common {
            background-color: #6c757d; /* Muted gray for back buttons */
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
            display: block; /* Make it a block element */
            width: fit-content; /* Fit content width */
            margin: 20px auto 0; /* Center the button below content */
        }

        .back-button-common:hover {
            background-color: #5a6268;
        }


        /* Responsive Adjustments */
        @media (max-width: 768px) {
            #main-app-content {
                padding: 15px;
            }
            #notes-list {
                grid-template-columns: 1fr;
            }
            #home-page-options {
                padding: 40px 20px;
            }
            #home-page-options button {
                width: 100%;
                font-size: 1.15em;
                padding: 15px 20px;
            }
            header h1 {
                font-size: 1.5em;
            }
            #add-note-section h2 {
                font-size: 1.5em;
            }
            .note-card h3 {
                font-size: 1.3em;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Simple Notes</h1>
        <div id="user-display">Public Access</div>
    </header>

    <div id="main-app-content">
        <div id="home-page-options">
            <h2>Welcome to your Notes!</h2>
            <button id="createNoteBtn">Create New Note</button>
            <button id="viewNotesBtn">View Current Notes</button>
        </div>

        <div id="add-note-section">
            <h2>Add New Note</h2>
            <form id="addNoteForm">
                <div class="form-group">
                    <label for="noteTitle">Note Title:</label>
                    <input type="text" id="noteTitle" required>
                </div>
                <div class="form-group">
                    <label for="noteContent">Note Content:</label>
                    <textarea id="noteContent" rows="5"></textarea>
                </div>
                <button type="submit">Add Note</button>
            </form>
            <button id="backToHomeFromCreate" class="back-button-common">Back to Options</button>
        </div>

        <div id="notes-list">
            <button id="backToHomeFromView" class="back-button-common">Back to Options</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. Firebase Configuration ---
            const firebaseConfig = {
                apiKey: "AIzaSyAddn3_6GWdQ8oeQl2-H1MfKyHrwUVh70Y",
                authDomain: "joesquicknotes.firebaseapp.com",
                projectId: "joesquicknotes",
                storageBucket: "joesquicknotes.firebasestorage.app",
                messagingSenderId: "903482150331",
                appId: "1:903482150331:web:609caf78b6fd54e094489e",
                measurementId: "G-J1K97GXPFR"
            };

            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            const notesCollection = db.collection('notes');

            let allNotesData = [];

            // --- 2. Global Variables & DOM Elements ---
            const homePageOptions = document.getElementById('home-page-options');
            const createNoteBtn = document.getElementById('createNoteBtn');
            const viewNotesBtn = document.getElementById('viewNotesBtn');
            const addNoteSection = document.getElementById('add-note-section');
            const addNoteForm = document.getElementById('addNoteForm');
            const noteTitleInput = document.getElementById('noteTitle');
            const noteContentInput = document.getElementById('noteContent');
            const notesListDiv = document.getElementById('notes-list');
            const userDisplay = document.getElementById('user-display');

            const backToHomeFromCreateBtn = document.getElementById('backToHomeFromCreate');
            const backToHomeFromViewBtn = document.getElementById('backToHomeFromView');


            // --- 3. Helper Functions ---
            function formatTimestamp(timestamp) {
                if (timestamp && timestamp.toDate) {
                    return timestamp.toDate().toLocaleString();
                }
                if (timestamp instanceof Date) {
                    return timestamp.toLocaleString();
                }
                return 'N/A';
            }

            function renderNotes(notesToRender) {
                notesListDiv.innerHTML = ''; // Clear existing notes
                // Append the back-to-home button for the notes list first
                notesListDiv.appendChild(backToHomeFromViewBtn);


                notesToRender.forEach(note => {
                    const noteCard = document.createElement('div');
                    noteCard.className = `note-card`;
                    noteCard.dataset.id = note.id;

                    noteCard.innerHTML = `
                        <h3>${note.title}</h3>
                        <p>${note.content ? note.content.replace(/\n/g, '<br>') : 'No content'}</p>
                        <div class="meta-info">
                            <span>Created: ${formatTimestamp(note.createdAt)}</span>
                            <button class="delete-note-btn" data-id="${note.id}">Delete</button>
                        </div>
                    `;
                    // Insert note cards *before* the back button if you want the button always at the bottom
                    notesListDiv.insertBefore(noteCard, backToHomeFromViewBtn);
                });

                addDeleteButtonListeners();
            }


            // --- 4. Firebase Operations ---
            async function addNote(noteData) {
                try {
                    await notesCollection.add({
                        title: noteData.title,
                        content: noteData.content,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    });
                    addNoteForm.reset();
                    noteTitleInput.focus();
                    alert("Note added successfully!");
                } catch (e) {
                    console.error("Error adding document: ", e);
                    alert("Error adding note. Please try again.");
                }
            }

            async function deleteNote(id) {
                if (!confirm("Are you sure you want to delete this note?")) {
                    return;
                }
                try {
                    await notesCollection.doc(id).delete();
                } catch (e) {
                    console.error("Error removing document: ", e);
                    alert("Error deleting note. Please try again.");
                }
            }

            // --- 5. Navigation Functions ---
            function showSection(sectionToShow) {
                // Hide all main sections first
                homePageOptions.classList.remove('active');
                addNoteSection.classList.remove('active');
                notesListDiv.classList.remove('active');

                homePageOptions.style.display = 'none';
                addNoteSection.style.display = 'none';
                notesListDiv.style.display = 'none';

                // Then show the requested section with animation
                if (sectionToShow === homePageOptions) {
                    homePageOptions.style.display = 'flex'; // Home is flex
                } else if (sectionToShow === addNoteSection) {
                    addNoteSection.style.display = 'block'; // Form is block
                    noteTitleInput.focus();
                } else if (sectionToShow === notesListDiv) {
                    notesListDiv.style.display = 'grid'; // Notes list is grid
                }

                // Trigger animation
                setTimeout(() => { // Small delay to ensure display change takes effect before adding active class
                    sectionToShow.classList.add('active');
                }, 50);
            }


            // --- 6. Event Listeners ---

            // Initial view
            showSection(homePageOptions);

            createNoteBtn.addEventListener('click', () => showSection(addNoteSection));
            viewNotesBtn.addEventListener('click', () => showSection(notesListDiv));

            backToHomeFromCreateBtn.addEventListener('click', () => showSection(homePageOptions));
            backToHomeFromViewBtn.addEventListener('click', () => showSection(homePageOptions));


            addNoteForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const newNote = {
                    title: noteTitleInput.value.trim(),
                    content: noteContentInput.value.trim() || ''
                };

                if (newNote.title) {
                    await addNote(newNote);
                } else {
                    alert("Note title is required!");
                }
            });

            function addDeleteButtonListeners() {
                document.querySelectorAll('.delete-note-btn').forEach(button => {
                    button.onclick = async (e) => {
                        const noteId = e.target.dataset.id;
                        await deleteNote(noteId);
                    };
                });
            }


            // --- 7. Real-time Firebase Listener ---
            notesCollection.orderBy('createdAt', 'desc').onSnapshot(snapshot => {
                allNotesData = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                renderNotes(allNotesData);
            }, error => {
                console.error("Error listening to notes:", error);
                if (error.code === 'permission-denied') {
                    alert("Permission Denied: Check your Firebase Firestore security rules!");
                }
            });

        });
    </script>
</body>
</html>
